(()=>{var e={590:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadsManager=void 0;var r=i(869);Object.defineProperty(t,"ThreadsManager",{enumerable:!0,get:function(){return r.ThreadsManager}})},869:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThreadsManager=void 0;var s=i(124);Object.defineProperty(t,"ThreadsManager",{enumerable:!0,get:function(){return r(s).default}})},124:function(e,t,i){"use strict";var r,s,n,a,o,c,h=this&&this.__classPrivateFieldSet||function(e,t,i,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,i):s?s.value=i:t.set(e,i),i},u=this&&this.__classPrivateFieldGet||function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const f=l(i(63));t.default=class{constructor(){r.add(this),s.set(this,new Map),n.set(this,0),a.set(this,void 0),h(this,a,new f.default,"f")}forEach(e,t,i={}){var l,f;const d=i.priority??"low",w=void 0===i.id?(h(this,n,(f=u(this,n,"f"),l=f++,f),"f"),l):i.id;if(u(this,s,"f").has(w))throw new Error("Invalid thread id");const m=u(this,r,"m",c).call(this,e,t,d);return u(this,s,"f").set(w,m),u(this,a,"f").addTask(w,d),new Promise((e=>u(this,r,"m",o).call(this,m,e,w)))}get count(){return u(this,a,"f").countThreads}get executionTime(){return u(this,a,"f").executionTime}get waitingTime(){return u(this,a,"f").waitingTime}stop(e){if(u(this,s,"f").has(e)){const t=u(this,s,"f").get(e);void 0!==t&&t.return(null)}}break(){for(let e of u(this,s,"f").values())e.return(null)}setExecutionTime(e){u(this,a,"f").setExecutionTime(e)}setWaitingTime(e){u(this,a,"f").setWaitingTime(e)}},s=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakSet,o=function e(t,i,s){t.next().done?(u(this,a,"f").removeTask(s),i()):setTimeout((()=>u(this,r,"m",e).call(this,t,i,s)),u(this,a,"f").waitingTime)},c=function*(e,t,i){const r=e[Symbol.iterator]();let s=r.next(),n=(new Date).getTime();for(;!s.done;)t(s.value),(new Date).getTime()-n>u(this,a,"f").getTaskExecutionTime(i)&&(yield 0,n=(new Date).getTime()),s=r.next()}},63:function(e,t){"use strict";var i,r,s,n,a,o,c,h=this&&this.__classPrivateFieldGet||function(e,t,i,r){if("a"===i&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?r:"a"===i?r.call(e):r?r.value:t.get(e)},u=this&&this.__classPrivateFieldSet||function(e,t,i,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,i):s?s.value=i:t.set(e,i),i};Object.defineProperty(t,"__esModule",{value:!0});class l{constructor(){i.add(this),s.set(this,void 0),n.set(this,100),a.set(this,100),u(this,s,h(l,r,"m",o).call(l),"f")}addTask(e,t){h(this,s,"f")[t].ids.push(e),h(this,i,"m",c).call(this)}removeTask(e){for(let t of Object.keys(h(this,s,"f")))h(this,s,"f")[t].ids=h(this,s,"f")[t].ids.filter((t=>t!==e));h(this,i,"m",c).call(this)}setExecutionTime(e){u(this,n,e,"f")}setWaitingTime(e){u(this,a,e,"f")}getTaskExecutionTime(e){const t=h(this,s,"f")[e];return Math.floor(t.executionTime/t.ids.length)}get executionTime(){return h(this,n,"f")}get waitingTime(){return h(this,a,"f")}get countThreads(){return Object.keys(h(this,s,"f")).reduce(((e,t)=>e+h(this,s,"f")[t].ids.length),0)}}t.default=l,r=l,s=new WeakMap,n=new WeakMap,a=new WeakMap,i=new WeakSet,o=function(){return{critical:{ids:[],executionTime:0},high:{ids:[],executionTime:0},low:{ids:[],executionTime:0}}},c=function(){let e=h(this,n,"f"),t=Object.keys(h(this,s,"f")).reduce(((e,t)=>(h(this,s,"f")[t].ids.length&&e++,e)),0);Object.keys(h(this,s,"f")).forEach((i=>{const r=h(this,s,"f")[i];r.ids.length?(r.executionTime=e*(e=>{switch(e){case 2:return.7;case 3:return.5;default:return 1}})(t),e-=r.executionTime,t--):r.executionTime=0}))}}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,i),n.exports}(()=>{const{ThreadsManager:e}=i(590);var t=0,r=0,s=0,n=new e;n.forEach(new Array(5e8),(()=>t++),{priority:"critical"}).then((()=>console.log("executed1"))),n.forEach(new Array(5e8),(()=>r++),{priority:"high"}).then((()=>console.log("executed2"))),n.forEach(new Array(5e8),(()=>s++)).then((()=>console.log("executed3")));const a=setInterval((()=>console.log("countCritical",t)),5e3),o=setInterval((()=>console.log("countHigh",r)),5e3),c=setInterval((()=>console.log("countLow",s)),5e3);setTimeout((()=>n.break()),6e4),setTimeout((()=>clearInterval(a)),6e4),setTimeout((()=>clearInterval(o)),6e4),setTimeout((()=>clearInterval(c)),6e4)})()})();